# AI Math Problem Solver

This project is a full-stack application designed to solve math problems from user-uploaded images. It consists of a Python Flask backend that handles image processing and communication with the OpenAI Vision API, and a Flutter web frontend that provides a user-friendly interface.

## Features

* **Image Upload**: Users can upload an image (PNG, JPG, etc.) containing a math problem through the web interface.
* **AI-Powered Solutions**: The backend sends the image to the OpenAI GPT-4o model, which analyzes the image, identifies the math problem, and generates a step-by-step solution.
* **Local Storage**: Uploaded images are stored securely on the local server for future reference.
* **Firebase Integration**: The solution and a reference to the uploaded image are stored in a Google Firestore database.
* **History Tracking**: Users can view a complete history of all previously submitted problems, including the original image and the corresponding solution.
* **Responsive Frontend**: The Flutter web app provides a clean and responsive UI for both uploading new problems and browsing the history.

---

## Project Structure

The project is divided into two main parts: the Flask backend API and the Flutter frontend application.

### 1. Flask Backend (`backend/`)

The backend is responsible for handling API requests, processing files, and communicating with external services like OpenAI and Firebase.

```
/math-problem-solver
|-- app.py              # Main Flask application file, initializes the app and CORS.
|-- config.py           # Configuration for API keys and Firebase credentials.
|-- requirements.txt    # Python dependencies for the backend.
|-- .env                # (To be created by user) For storing secret keys.
|-- firebase_credentials.json # (To be added by user) Firebase service account key.
|-- routes/
|   |-- main_routes.py  # Defines all API endpoints (e.g., /api/upload, /api/history).
|-- services/
|   |-- firebase_service.py # Handles all interactions with Firestore (save, retrieve).
|   |-- openai_service.py   # Handles communication with the OpenAI API.
|-- utils/
|   |-- helpers.py      # Utility functions (e.g., encoding images to base64).
|-- uploads/
|   |--                 # This folder stores all user-uploaded images.
|-- templates/
|   |-- index.html      # A simple HTML page for initial testing (not used by Flutter).
|-- static/
|-- css/
|-- style.css
```
### 2. Flutter Frontend (`flutter_app/`)

The frontend is a single-page web application that allows users to interact with the backend API.

```
/flutter_math_solver
|-- lib/
|   |-- main.dart         # The entry point of the Flutter application.
|   |-- api/
|   |   |-- api_service.dart # Handles all HTTP requests to the Flask backend.
|   |-- models/
|   |   |-- history_item.dart # Data model for a single history entry.
|   |-- screens/
|       |-- main_screen.dart       # Main screen with bottom navigation.
|       |-- upload_screen.dart     # UI for uploading a new problem image.
|       |-- history_screen.dart    # UI for displaying the list of past problems.
|       |-- history_detail_screen.dart # UI for showing the details of a single history item.
|-- pubspec.yaml        # Flutter project dependencies and configuration.
|-- web/
|-- index.html      # The main HTML file for the Flutter web app.
```
## Data Structure

The application uses Google Firestore to persist the results. A single collection named `Questions` is used.

Each document in the `Questions` collection has the following structure:

| Field            | Type      | Description                                                 |
| ---------------- | --------- | ----------------------------------------------------------- |
| `id`             | `string`  | The unique ID of the document (auto-generated by Firestore).|
| `local_filename` | `string`  | The unique filename of the image stored in the `uploads/` folder. |
| `answer`         | `string`  | The complete, step-by-step solution from the OpenAI API.    |
| `timestamp`      | `timestamp` | The server timestamp of when the entry was created.       |

---

## Setup and Installation

Follow these steps to get both the backend and frontend running locally.

### Prerequisites

* Python 3.8+
* Flutter SDK
* A Google Firebase project
* An OpenAI API Key
* Homebrew (for macOS users, if PDF support were needed)

### 1. Backend Setup (Flask API)

1.  **Clone/Download the Project**: Place the `math-problem-solver` directory on your local machine.

2.  **Firebase Setup**:
    * Go to your [Firebase Console](https://console.firebase.google.com/), create a new project.
    * Enable **Firestore Database**.
    * Go to **Project Settings** > **Service accounts**.
    * Click **"Generate new private key"** and download the JSON file.
    * Rename the downloaded file to `firebase_credentials.json` and place it in the root of the `math-problem-solver` directory.

3.  **Environment Variables**:
    * Create a file named `.env` in the root of the `math-problem-solver` directory.
    * Add your OpenAI API key to this file:
        ```
        OPENAI_API_KEY="your-actual-openai-api-key"
        ```

4.  **Install Dependencies**:
    * Navigate to the `math-problem-solver` directory in your terminal.
    * Create and activate a virtual environment:
        ```bash
        python3 -m venv venv
        source venv/bin/activate
        ```
    * Install the required Python packages:
        ```bash
        pip install -r requirements.txt
        ```

5.  **Run the Backend Server**:
    ```bash
    python app.py
    ```
    The API server should now be running at `http://127.0.0.1:5000`.

### 2. Frontend Setup (Flutter Web App)

1.  **Clone/Download the Project**: Place the `flutter_math_solver` directory on your local machine.

2.  **Get Dependencies**:
    * Navigate to the `flutter_math_solver` directory in your terminal.
    * Run the following command to install the necessary packages:
        ```bash
        flutter pub get
        ```

3.  **Run the Frontend App**:
    * Make sure your Flask backend is already running.
    * Ensure you have a Chrome browser available for Flutter to use.
    * In the `flutter_math_solver` directory, run:
        ```bash
        flutter run -d chrome
        ```

The Flutter application will launch in a Chrome window, connected to your local backend. You can now upload images and view the history.